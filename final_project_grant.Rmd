---
title: "final_project_grant"
author: "Grant Schumock"
date: "12/2/2019"
  html_document:
    code_folding: "hide"
    toc: TRUE
    toc_float: TRUE
---

Adding and cleaning Census Poverty Data

```{r,message=FALSE}
library(tidyverse)
data=read.csv("census_poverty_data.csv",stringsAsFactors = FALSE)
data=filter(data,State!="      United States"&State!="     United States"& State!="District of Columbia"&State!="United States")

names(data)[1:2]<-c("state","poverty")
names(data)[4]<-"year"

skel=expand_grid(sort(unique(data$state)),min(data$year):(max(data$year)+2))
names(skel)<-c("state","year")



sk1=filter(skel,year==2007|year==2008|year==2009)
sk1=left_join(sk1,filter(data,year==2007),by="state")

sk2=filter(skel,year==2010|year==2011|year==2012)
sk2=left_join(sk2,filter(data,year==2010),by="state")

sk3=filter(skel,year==2013|year==2014|year==2015)
sk3=left_join(sk3,filter(data,year==2013),by="state")

sk4=filter(skel,year==2016|year==2017|year==2018)
sk4=left_join(sk4,filter(data,year==2016),by="state")

data=rbind(sk1,sk2,sk3,sk4)
data=data[,1:3]
names(data)<-c("state","year","poverty")



# Mental Health Data
cleaned=1
if(cleaned==0){
data.2016=read.csv("mha2016.csv",stringsAsFactors = FALSE)
data.2017=read.csv("mha2017.csv",stringsAsFactors = FALSE)
data.2018=read.csv("mha2018.csv",stringsAsFactors = FALSE)
data.2019=read.csv("mha2019.csv",stringsAsFactors = FALSE)
data.2020=read.csv("mha2020.csv",stringsAsFactors = FALSE)

names(data.2017)[2]<-"State"

data.2016=data.2016[,c("State","Percent","Year")]
data.2017=data.2017[,c("State","Percent","Year")]
data.2018=data.2018[,c("State","Percent","Year")]
data.2019=data.2019[,c("State","Percent","Year")]
data.2020=data.2020[,c("State","Percent","Year")]
states=sort(unique(data.2020$State))
# Remove DC
states=states[-9]
# Find which states don't match up for each year

states==sort(unique(data.2016$State))
sort(unique(data.2016$State))[8]
# remove DC from 2016 data
data.2016=filter(data.2016,State!="DC")      
states==sort(unique(data.2016$State))
data.2016$State[35]="Louisiana"
states==sort(unique(data.2016$State))
data.2017=filter(data.2017,State!="District of Columbia")
states==sort(unique(data.2017$State))
data.2018=filter(data.2018,State!="District of Columbia")
data.2018$State[9]="Wyoming"
states==sort(unique(data.2018$State))
data.2019=filter(data.2019,State!="District of Columbia"&State!="")
states==sort(unique(data.2019$State))

mh.data=rbind(data.2016,data.2017,data.2018,data.2019,data.2020)
mh.data$Year=mh.data$Year-1      
mh.data$Percent[51]=42.1
mh.data=filter(mh.data,State!="District of Columbia")
write.csv(mh.data,"mh.data.csv")
}
mh.data=read.csv("mh.data.csv",stringsAsFactors = FALSE)


# Rand Laws Data

data.rand=read.csv("rand.laws.database.csv",stringsAsFactors = FALSE)

```
